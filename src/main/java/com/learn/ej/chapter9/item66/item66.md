# 네이티브 메서드는 신중히 사용하라



## 전통적인 네이티브 메서드의 주요 쓰임은 3가지이다.

- 레지스트리 같은 플랫폼 특화 기능을 사용한다.
- 네이티브 코드로 작성된 기존 라이브러리를 사용한다.
- 성능 개선을 목적으로 성능에 결정적인 영향을 주는 영역만 따로 네이티브 언어로 작성한다.



다만 자바가 성숙해지면서 하부 플랫폼들의 기능을 점차 흡수하고 있고 네이티브 메서드를 사용할 필요가 계속 줄어들고 있다.

- Java 9 부터는 `process API`를 추가해 OS 프로세스에 접근할 수 있다.



## 성능을 개선할 목적으로 네티이브 메서드를 사용하는것은 거의 권장하지 않는다.

- Java 1.1 시절 `BigInteger`은 C로 작성한 고성능 라이브러리에 의존해 왔으나, Java 3 때 Java로 재구현 및 튜닝의 결과 원래의 네이티브 구현보다도 빨라졌다.

네이티브 라이브러리 쪽은 **GNU 다중 정밀 연산 라이브러리 (GMP)를 필두로 개선 작업이 계속되어 왔으며**, 고성능 다중 정밀 연산이 필요한 경우 네이티브 메서드를 통해 GMP를 사용하는걸 고려하는 것도 좋다.



## 네이티브 메서드에는 심각한 단점이 있다.

1. 네이티브 언어는 안전하지 않으며, Java에 비해 플랫폼을 많이 타서 이식성도 낮다.
2. 네이티브 메모리는 가비지 컬렉터가 메모리를 자동으로 회수하지 못하며 심지어 추적조차 할 수 없다.
3. 자바코드와 네이티브 코드의 경계를 넘나들때마다 비용도 추가된다.
4. 네이티브 메서드와 자바 코드 사이의 접착 코드(glue code) 작성은 가독성이 떨어지며 귀찮은 작업이다.



> 네이티브 메서드가 성능을 개선해 주는 일은 많지 않으며, 네이티브 코드는 최소한만 사용하고 철저히 테스트하라.

